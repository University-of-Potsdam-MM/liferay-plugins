(function($){if($.fn.validate){$.datepicker._selectDate2=$.datepicker._selectDate;$.extend($.datepicker.regional[''],{validateDate:'Bitte tragen Sie ein gÃ¼ltiges Datum ein.',validateDateMin:'Bitte tragen Sie ein Datum ein, welches am oder nach dem {0} liegt.',validateDateMax:'Bitte tragen Sie ein Datum ein, welches am oder vor dem {0} liegt.',validateDateMinMax:'Bitte tragen Sie ein Datum ein, welches zwischen dem {0} und dem {1} liegt.',validateDateCompare:'Bitte tragen Sie ein Datum ein, welches {0} {1}',validateDateToday:'heute',validateDateOther:'dem Startdatum liegt.',validateDateEQ:'gleich',validateDateNE:'ungleich',validateDateLT:'vor',validateDateGT:'nach',validateDateLE:'nicht nach',validateDateGE:'nicht vor'});$.extend($.datepicker._defaults,$.datepicker.regional['']);$.extend($.datepicker,{_selectDate:function(id,dateStr){this._selectDate2(id,dateStr);var input=$(id),inst=this._getInst(input[0]);if(!inst.inline&&$.fn.validate)input.parents('form').validate().element(input)},errorPlacement:function(error,element){var trigger=element.next('.'+$.datepicker._triggerClass),before=false;if(trigger.length==0){trigger=element.prev('.'+$.datepicker._triggerClass);before=(trigger.length>0)};error[before?'insertBefore':'insertAfter'](trigger.length>0?trigger:element)},errorFormat:function(inst,message,params){var format=$.datepicker._get(inst,'dateFormat');$.each(params,function(i,v){message=message.replace(new RegExp('\\{'+i+'\\}','g'),$.datepicker.formatDate(format,v)||'nothing')});return message}});var lastElement=null;$.validator.addMethod('dpDate',function(value,element,params){lastElement=element;var inst=$.datepicker._getInst(element),dateFormat=$.datepicker._get(inst,'dateFormat');try{var date=$.datepicker.parseDate(dateFormat,value,$.datepicker._getFormatConfig(inst)),minDate=$.datepicker._determineDate(inst,$.datepicker._get(inst,'minDate'),null),maxDate=$.datepicker._determineDate(inst,$.datepicker._get(inst,'maxDate'),null),beforeShowDay=$.datepicker._get(inst,'beforeShowDay');return this.optional(element)||!date||((!minDate||date>=minDate)&&(!maxDate||date<=maxDate)&&(!beforeShowDay||beforeShowDay.apply(element,[date])[0]))}catch(e){return false}},function(params){var inst=$.datepicker._getInst(lastElement),minDate=$.datepicker._determineDate(inst,$.datepicker._get(inst,'minDate'),null),maxDate=$.datepicker._determineDate(inst,$.datepicker._get(inst,'maxDate'),null),messages=$.datepicker._defaults;return(minDate&&maxDate?$.datepicker.errorFormat(inst,messages.validateDateMinMax,[minDate,maxDate]):(minDate?$.datepicker.errorFormat(inst,messages.validateDateMin,[minDate]):(maxDate?$.datepicker.errorFormat(inst,messages.validateDateMax,[maxDate]):messages.validateDate)))});$.validator.addClassRules('dpDate',{dpDate:true});var comparisons={equal:'eq',same:'eq',notEqual:'ne',notSame:'ne',lessThan:'lt',before:'lt',greaterThan:'gt',after:'gt',notLessThan:'ge',notBefore:'ge',notGreaterThan:'le',notAfter:'le'};$.validator.addMethod('dpCompareDate',function(value,element,params){if(this.optional(element))return true;params=normaliseParams(params);var thisDate=$(element).datepicker('getDate'),thatDate=extractOtherDate(element,params[1]);if(!thisDate||!thatDate)return true;lastElement=element;var result=true;switch(comparisons[params[0]]||params[0]){case'eq':result=(thisDate.getTime()==thatDate.getTime());break;case'ne':result=(thisDate.getTime()!=thatDate.getTime());break;case'lt':result=(thisDate.getTime()<thatDate.getTime());break;case'gt':result=(thisDate.getTime()>thatDate.getTime());break;case'le':result=(thisDate.getTime()<=thatDate.getTime());break;case'ge':result=(thisDate.getTime()>=thatDate.getTime());break;default:result=true};return result},function(params){var inst=$.datepicker._getInst(lastElement),messages=$.datepicker._defaults;params=normaliseParams(params);var thatDate=extractOtherDate(lastElement,params[1],true);thatDate=(params[1]=='today'?messages.validateDateToday:(thatDate?$.datepicker.formatDate($.datepicker._get(inst,'dateFormat'),thatDate,$.datepicker._getFormatConfig(inst)):messages.validateDateOther));return messages.validateDateCompare.replace(/\{0\}/,messages['validateDate'+(comparisons[params[0]]||params[0]).toUpperCase()]).replace(/\{1\}/,thatDate)});function normaliseParams(params){if(typeof params=='string'){params=params.split(' ')}else if(!$.isArray(params)){var opts=[];for(var name in params){opts[0]=name;opts[1]=params[name]};params=opts};return params};function extractOtherDate(element,source,noOther){if(source.constructor==Date)return source;var inst=$.datepicker._getInst(element),thatDate=null;try{if(typeof source=='string'&&source!='today')thatDate=$.datepicker.parseDate($.datepicker._get(inst,'dateFormat'),source,$.datepicker._getFormatConfig(inst))}catch(e){};thatDate=(thatDate?thatDate:(source=='today'?new Date():(noOther?null:$(source).datepicker('getDate'))));if(thatDate)thatDate.setHours(0,0,0,0);return thatDate}}})(jQuery);